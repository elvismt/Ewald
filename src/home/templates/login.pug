extends ../../common/templates/base.pug

block base_body
    div(class="w3-display-container" style="width:100%;height:100%;")
        div(class="w3-display-middle w3-card w3-white")
            div(class="w3-container w3-teal")
                p Ewald
            form(id="login-form" class="w3-container w3-padding-large")
                input(name="uname" class="w3-input" type="text" style="min-width:250px")
                label(class="w3-label") User name
                input(name="psw" class="w3-input" type="password" style="min-width:250px")
                label(class="w3-label") Password
                br
                button(class="w3-btn w3-teal" style="margin-top:16px;") Login
    div(id="login-failed-modal" class="w3-modal w3-animate-opacity")
        div(class="w3-modal-content w3-card-8")
            header(class="w3-container w3-teal")
                span(onclick="$('#login-failed-modal').css('display', 'none')" class="w3-closebtn") &times;
                h4 Login failed!
            div(class="w3-container")
                p Try again or create account
    script.
        $(document).on('submit', '#login-form', function(event) {
            event.preventDefault();
            $.ajax({
                type: 'POST',
                url: '/login/',
                contentType: 'application/json',
                data: JSON.stringify({
                    defcon1: $('input[name=uname]').val(),
                    defcon2: $('input[name=psw]').val(),
                }),
                success: function() {
                    window.location.href = '/';
                },
                error: function() {
                    $('#login-failed-modal').css('display', 'block');
                }
            });
        });
